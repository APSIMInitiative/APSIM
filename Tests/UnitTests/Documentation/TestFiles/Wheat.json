[{"type": "APSIM.Shared.Documentation.Section", "text": "The APSIM Wheat Model", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "The model has been developed using the Plant Modelling Framework (PMF) of [brown_plant_2014]. Thisnew framework provides a library of plant organ and process submodels that can be coupled, at runtime, to construct amodel in much the same way that models can be coupled to construct a simulation.This means that dynamic compositionof lower level process and organ classes(e.g.photosynthesis, leaf) into larger constructions(e.g.maize, wheat,sorghum) can be achieved by the model developer without additional coding."},{"type": "APSIM.Shared.Documentation.Paragraph", "text": "_Brown, H.E., Huth, N.I. and Holzworth, D.P._The APSIM wheat model has been developed using the Plant Modelling Framework (PMF) of [brown_plant_2014]. This new framework provides a library of plant organ and process submodels that can be coupled, at runtime, to construct a model in much the same way that models can be coupled to construct a simulation. This means that dynamic composition of lower level process and organ classes (e.g. photosynthesis, leaf) into larger constructions (e.g. maize, wheat, sorghum) can be achieved by the model developer without additional coding.The wheat model consists of:* a phenology model to simulate development through sequential developmental phases  * a structure model to simulate plant morphology * a collection of organs to simulate the various plant parts  * an arbitrator to allocate resources (N, biomass) to the various plant organs  This work builds upon earlier APSIM Wheat models such as NWheat ([Asseng200225], [KeatingNWheat]), NWheatS ([Asseng1998163]), Cropmod-Wheat ([Wang2002GenericCropModel]), and the earlier versions developed in Plant (<a href=http://www.apsim.info/Documentation/Model,CropandSoil/CropModuleDocumentation/Wheat.aspx>APSIM Wheat 7.5</a>) and then within the Plant Modelling Framework ([brown_plant_2014])."},{"type": "APSIM.Shared.Documentation.Paragraph", "text": "The model is constructed from the following list of software components. Details of the implementation and model parameterisation are provided in the following sections."},{"type": "APSIM.Shared.Documentation.Section", "text": "Plant Model Components", "children": [{"type": "APSIM.Shared.Documentation.Table", "text": "Table"}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Composite Biomass", "children": [{"type": "APSIM.Shared.Documentation.Table", "text": "Table"}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Cultivars", "children": [{"type": "APSIM.Shared.Documentation.Table", "text": "Table"}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Child Components", "children": [{"type": "APSIM.Shared.Documentation.Section", "text": "Arbitrator", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "The Arbitrator class determines the allocation of dry matter (DM) and Nitrogen between each of the organs in the crop model. Each organ can have up to three different pools of biomass:* **Structural biomass** which is essential for growth and remains within the organ once it is allocated there.* **Metabolic biomass** which generally remains within an organ but is able to be re allocated when the organ senesces and may be retranslocated when demand is high relative to supply.* **Storage biomass** which is partitioned to organs when supply is high relative to demand and is available for retranslocation to other organs whenever supply from uptake, fixation, or re allocation is lower than demand.The process followed for biomass arbitration is shown in the figure below. Arbitration calculations are triggered by a series of events (shown below) that are raised every day.  For these calculations, at each step the Arbitrator exchange information with each organ, so the basic computations of demand and supply are done at the organ level, using their specific parameters. 1. **doPotentialPlantGrowth**.  When this event occurs, each organ class executes code to determine their potential growth, biomass supplies and demands.  In addition to demands for structural, non structural and metabolic biomass (DM and N) each organ may have the following biomass supplies: * **Fixation supply**.  From photosynthesis (DM) or symbiotic fixation (N)* **Uptake supply**.  Typically uptake of N from the soil by the roots but could also be uptake by other organs (eg foliage application of N).* **Retranslocation supply**.  Storage biomass that may be moved from organs to meet demands of other organs.* **Reallocation supply**. Biomass that can be moved from senescing organs to meet the demands of other organs.2. **doPotentialPlantPartitioning.** On this event the Arbitrator first executes the DoDMSetup() method to gather the DM supplies and demands from each organ, these values are computed at the organ level.  It then executes the DoPotentialDMAllocation() method which works out how much biomass each organ would be allocated assuming N supply is not limiting and sends these allocations to the organs.  Each organ then uses their potential DM allocation to determine their N demand (how much N is needed to produce that much DM) and the arbitrator calls DoNSetup() to gather the N supplies and demands from each organ and begin N arbitration.  Firstly DoNReallocation() is called to redistribute N that the plant has available from senescing organs.  After this step any unmet N demand is considered as plant demand for N uptake from the soil (N Uptake Demand).3. **doNutrientArbitration.** When this event occurs, the soil arbitrator gets the N uptake demands from each plant (where multiple plants are growing in competition) and their potential uptake from the soil and determines how much of their demand that the soil is able to provide.  This value is then passed back to each plant instance as their Nuptake and doNUptakeAllocation() is called to distribute this N between organs.  4. **doActualPlantPartitioning.**  On this event the arbitrator call DoNRetranslocation() and DoNFixation() to satisfy any unmet N demands from these sources.  Finally, DoActualDMAllocation is called where DM allocations to each organ are reduced if the N allocation is insufficient to achieve the organs minimum N concentration and final allocations are sent to organs. ![Schematic showing the procedure for arbitration of biomass partitioning.  Pink boxes represent events that occur every day and their numbering shows the order of calculations. Blue boxes represent the methods that are called when these events occur.  Orange boxes contain properties that make up the organ/arbitrator interface.  Green boxes are organ specific properties.](ArbitratorSequenceDiagram.png)"}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Phenology", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "The phenological development is simulated as the progression through a series of developmental phases, each bound by distinct growth stage."},{"type": "APSIM.Shared.Documentation.Paragraph", "text": "Wheat exhibits a range of developmental responses to environment and these are strongly influenced by genotype characteristics. Temperature is the primary driver of development, increasing development rates and decreasing phase durations as it increases.  These affects are captured by thermal time.  However, wheat also exhibits cold and photoperiod sensitivities in its Vernalisaing phase and further photoperiod sensitivity in the SpikeletDifferenation and HeadEmergence phases.  Photoperiod responses are seen as a reduction in the length of a phase for a photoperiod sensitive genotype in response to a longer photoperiod.  Vernalisation responses are more complicated as they are driven by cool temperature but interact with photoperiod.  For vernalisation sensitive varieties (Winter types), exposure to cool temperatures and/or short photoperiods during the Vernalising phase may reduce its thermal time duration.  APSIM wheat implements the Cereal Anthesis Molecular Phenology (CAMP) model to simulate development.  It is based on the Kirby Framework which assumes the timing of anthesis is a result of the timing of flag leaf and an additional thermal time passage from there to heading then anthesis.  It also assumes the timing of flag leaf is a result of the Final Leaf Number (which sets a target) and leaf appearance rate (which sets the rate of progress toward the target).  Leaf appearance rate is a function of Thermal time and a genotype specific Phyllochron which changes with Haun stage as described by [Jamieson_LeafAppearance_1995].  Final Leaf Number (FLN) is set on the day that terminal spikelet occurs as: FLN = 2.85 + 1.1 * TSHS  Where TSHS is the Haun stage on the day terminal spikelet stage occurs.  Terminal spikelet is at the end of the SpikeletDifferentaiation phase which is preceeded by the Emerging and Vernalising phases.  The mechanisums for progress through each of these phase are described below"}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Structure", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "The structure model simulates morphological development of the plant to inform the Leaf class when and how many leaves and branches appear and provides an estimate of height."}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Grain", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "This organ uses a generic model for plant reproductive components.  Yield is calculated from its components in terms of organ number and size (for example, grain number and grain size)."}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Root", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "The root model calculates root growth in terms of rooting depth, biomass accumulation and subsequent root length density in each soil layer."}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Leaf", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "The leaves are modelled as a set of leaf cohorts and the properties of each of these cohorts are summed to give overall values for the leaf organ.  A cohort represents all the leaves of a given main  stem node position including all of the branch leaves appearing at the same time as the given main stem leaf ([lawless2005wheat]).  The number of leaves in each cohort is the product of the number of plants per m^2^ and the number of branches per plant.  The *Structure* class models the appearance of main stem leaves and branches.  Once cohorts are initiated the *Leaf* class models the area and biomass dynamics of each.  It is assumed all the leaves in each cohort have the same size and biomass properties.  The modelling of the status and function of individual cohorts is delegated to *LeafCohort* classes."}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Spike", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "This organ is simulated using a GenericOrgan type.  It is parameterised to calculate the growth, senescence, and detachment of any organ that does not have specific functions."}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Stem", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "This organ is simulated using a GenericOrgan type.  It is parameterised to calculate the growth, senescence, and detachment of any organ that does not have specific functions."}]},{"type": "APSIM.Shared.Documentation.Section", "text": "MortalityRate", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "A constant function (name=value)"}]},{"type": "APSIM.Shared.Documentation.Section", "text": "SeedMortalityRate", "children": [{"type": "APSIM.Shared.Documentation.Paragraph", "text": "A constant function (name=value)"}]}]}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Validation", "children": [{"type": "APSIM.Shared.Documentation.Section", "text": "List of experiments", "children": [{"type": "APSIM.Shared.Documentation.Table", "text": "Table"}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Experiment", "children": [{"type": "APSIM.Shared.Documentation.GraphPage", "children": [{"type": "APSIM.Shared.Documentation.Graph", "text": "Graph"}]}]},{"type": "APSIM.Shared.Documentation.Section", "text": "Simulation", "children": [{"type": "APSIM.Shared.Documentation.GraphPage", "children": [{"type": "APSIM.Shared.Documentation.Graph", "text": "Graph"}]}]}]},{"type": "APSIM.Shared.Documentation.Section", "text": "DontShowGraphs", "children": [{"type": "APSIM.Shared.Documentation.Section", "text": "List of experiments", "children": [{"type": "APSIM.Shared.Documentation.Table", "text": "Table"}]}]}]