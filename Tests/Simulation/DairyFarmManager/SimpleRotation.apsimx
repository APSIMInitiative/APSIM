<?xml version="1.0" encoding="utf-8"?>
<Simulations xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="34">
  <Name>Simulations</Name>
  <Simulation>
    <Name>SimpleRotation</Name>
    <Memo>
      <Name>Memo</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <MemoText><![CDATA[Look at ReportTop and see what the output looks like after the cows are weaned]]></MemoText>
    </Memo>
    <Clock>
      <Name>Clock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <StartDate>2001-10-01T00:00:00</StartDate>
      <EndDate>2001-10-31T00:00:00</EndDate>
    </Clock>
    <Summary>
      <Name>SummaryFile</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
    </Summary>
    <SoilArbitrator>
      <Name>SoilArbitrator</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
    </SoilArbitrator>
    <Weather>
      <Name>Weather</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <FileName>%root%\Examples\WeatherFiles\lincoln.met</FileName>
      <ExcelWorkSheetName />
    </Weather>
    <Stock>
      <Name>Stock</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <RandSeed>9999</RandSeed>
      <GenoTypes />
      <Sheep />
      <Cattle />
      <PaddockList>
        <PaddockInit>
          <Forages />
          <Name />
          <Area>1</Area>
          <Slope>0</Slope>
        </PaddockInit>
      </PaddockList>
      <EnterpriseList />
      <GrazingPeriods />
    </Stock>
    <Manager>
      <Name>Ex_TargetRotationLength</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <Script>
        <DoVerbose>False</DoVerbose>
        <StockingRate>3</StockingRate>
        <CurrentLocationName>Paddock01</CurrentLocationName>
        <Seperator1>
        </Seperator1>
        <TargetRotationLength>4</TargetRotationLength>
        <PostGrazingResidual>1500</PostGrazingResidual>
        <HarvestExcessHerbage>False</HarvestExcessHerbage>
        <Seperator2>
        </Seperator2>
        <SilageEveryDay>0.25</SilageEveryDay>
        <SilageOnPastureMass>5</SilageOnPastureMass>
        <TriggerPastureMass>1500</TriggerPastureMass>
        <Seperator3>
        </Seperator3>
        <NumCows>3</NumCows>
        <pastLocationName>
        </pastLocationName>
        <newLocationName>
        </newLocationName>
        <CurrentLocationNum>0</CurrentLocationNum>
        <NumPaddocks>0</NumPaddocks>
        <listOfPaddockInfo>
        </listOfPaddockInfo>
      </Script>
      <Code><![CDATA[using System;
using Models.Core;
using Models.Utilities;
using Models.GrazPlan;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;
using Models.PMF;
using Models.Soils;
using System.Collections;
using System.Collections.Generic;
using Models.AgPasture;
using System.Diagnostics;

namespace Models
{

    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Stock Cows;
        [Link] Supplement Feed;
        [Link] Zone[] Paddocks;
        [Link] ISummary summary = null;
        [Link] Simulation Farm;

        //List<AgPasture.PastureSpecies> Pasture = new List<AgPasture.PastureSpecies>();

        [Serializable]
        public class PaddockInfo
        {
            public string paddockName;
            public double totalBiomass;
            public double harvestableBiomass;
            public int paddockNum;
            public double paddockArea;
        }

        [Description("Do verbose reporting from this script (tick for yes): ")] public bool DoVerbose { get; set; }
        [Separator("some text")]         //[Description("===============================")] public string Seperator0 { get; set; }

        [Description("Whole-farm stocking rate (head/ha): ")]
        public double StockingRate { get; set; }
        [Description("Initial location of the cows (paddock name): ")] public string CurrentLocationName { get; set; }
        [Description("===============================")] public string Seperator1 { get; set; }

        [Description("Target rotation length (days/paddock): ")] public int TargetRotationLength { get; set; }
        [Description("Post grazing residual (kgDM/ha): ")] public double PostGrazingResidual { get; set; }
        [Description("Harvest excess herbage above residual when cows leave the paddock?: ")] public bool HarvestExcessHerbage { get; set; }
        [Description("===============================")] public string Seperator2 { get; set; }

        [Description("Baseline feeding of silage (kgDM/head/day): ")] public double SilageEveryDay { get; set; }
        [Description("Low pasture mass feeding of silage (kgDM/head/day): ")] public double SilageOnPastureMass { get; set; }
        [Description("Trigger pasture mass for above rule (kgDM/ha): ")] public double TriggerPastureMass { get; set; }






        [Description("===============================")] public string Seperator3 { get; set; }


        public int NumCows { get; set; } // number of cows on the whole farm
        public string pastLocationName { get; set; }  // name of the paddock that the cows are currently in
        public string newLocationName { get; set; }  // name of the paddock that the cows are currently in
        public int CurrentLocationNum { get; set; }  // name of the paddock that the cows are currently in
        public int NumPaddocks { get; set; }
        //public double[] HarvestableBiomass { get; set; }

        private int group_count; // how many groups are there in the simulation
        private int g = 1;      // index to the groups of animals

        //private int DaysPerPaddock;
        private int DaysInThisPaddock;
        private bool MoveToday = false;

        public event BiomassRemovedDelegate BiomassRemoved;
        public List<PaddockInfo> listOfPaddockInfo { get; set; }


        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            summary.WriteMessage(this, "Initialising the paddock information");
            listOfPaddockInfo = new List<PaddockInfo>();


            GetPaddockInfo();
            //HarvestableBiomass = Farm.

            NumCows = (int)(Math.Round(StockingRate * Farm.Area, 0));

            SetInitialCowStuff();

            if (NumCows > 0)
                Cows.Move(g, CurrentLocationName);

            summary.WriteMessage(this, "     The number of animals has been rounded to " + NumCows + " from " + (StockingRate * Farm.Area));
            summary.WriteMessage(this, "     The animals will begin in " + CurrentLocationName + " which is paddock number " + CurrentLocationNum + " in the simulation");
            summary.WriteMessage(this, "     The area of the whole farm is " + Farm.Area + " ha");

            DaysInThisPaddock = -1;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            UpdatePaddockInfo();

            if ((Cows.LactatingAll > 2) && (Cows.NoSucklingAll > 0))
            	WeanCalves();
            if ((Cows.LactatingAll > 4) && (Cows.LactatingAll < 6))
            	SellCalves();

            MoveToday = false;
            // how many days in this paddock?  Ready to move?
            DaysInThisPaddock += 1;
            if (DaysInThisPaddock >= TargetRotationLength)
            {
                MoveToday = true;

                pastLocationName = CurrentLocationName;
                if (CurrentLocationNum < NumPaddocks - 1)
                {
                    CurrentLocationNum += 1;
                    newLocationName = listOfPaddockInfo[CurrentLocationNum].paddockName;
                }
                else
                {
                    CurrentLocationNum = 0;
                    newLocationName = listOfPaddockInfo[CurrentLocationNum].paddockName;
                }
                CurrentLocationName = listOfPaddockInfo[CurrentLocationNum].paddockName;


                if (HarvestExcessHerbage)
                {
                    foreach (Zone paddock in Paddocks)
                    {
                        if (paddock.Name == pastLocationName)
                        {
                            double pastPaddockBiomass = 0.0;
                            foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                                pastPaddockBiomass += plant.AboveGroundWt;
                            if (pastPaddockBiomass > (PostGrazingResidual + 250.0))  //why the 250?
                            {
                                foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                                    plant.Graze(amount: (plant.AboveGroundWt / pastPaddockBiomass * PostGrazingResidual), type: "SetResidueAmount");

                            }
                        }
                    }
                }

                if (NumCows > 0)
                    Cows.Move(g, listOfPaddockInfo[CurrentLocationNum].paddockName);

                if (DoVerbose)
                    summary.WriteMessage(this, "moving Stock to " + listOfPaddockInfo[CurrentLocationNum].paddockName);

                DaysInThisPaddock = 0;
            }

            if (SilageEveryDay > 0)
            {
                Feed.Feed("silage_highquality", SilageEveryDay * Cows.NumberAll, CurrentLocationName);
            }

            if ((SilageOnPastureMass > 0) && (listOfPaddockInfo[CurrentLocationNum].harvestableBiomass < TriggerPastureMass))
            {
                Feed.Feed("silage_highquality", SilageOnPastureMass * Cows.NumberAll, CurrentLocationName);
            }


        } // End of Do Management

        [EventSubscribe("DoManagementCalculations")]
        private void DoManagementCalculations(object sender, EventArgs e)
        {
            //this is after Stock have eaten
            UpdatePaddockInfo();

        }

        public void SetInitialCowStuff()
        {
            if (NumCows > 0)
            {
                g = Cows.NoGroups + 1;

                StockBuy purchase = new StockBuy();
                purchase.Genotype = "Friesian";
                purchase.Number = NumCows;
                purchase.Sex = "heifers";
                purchase.Age = 36;       // age in months
                purchase.Weight = 600.0;  // live weight in kg
                purchase.UseTag = g + 1;
                purchase.MatedTo = "Friesian";
                purchase.Pregnant = 280;  // days pregnant, 0 = non pregnant, 1 = pregnant
                purchase.Lactating = 0;  // 0 for dry, 1 for lactating
                purchase.NumYoung = 1;
                purchase.YoungWt = 45;

                Cows.Buy(purchase);
            }
        }

        public void WeanCalves()
        {
                StockWean weanData = new StockWean();
				weanData.Group = 0;
				weanData.Sex = "all";
				weanData.Number = Cows.NumberAll;

				Cows.Wean(weanData);
        }

        public void SellCalves()
        {
				double weanAge = 0.25 * 365;
				int NumGroups = Cows.NoGroups;

			  for (int gg = 1; gg <= NumGroups; gg++)
              {
                  StockSplit split = new StockSplit();
                  split.Group = gg;
                  split.Type = "age";
                  split.Value = weanAge;  

                Cows.Split(split);
              }

              NumGroups = Cows.NoGroups;
              for (int gg = 1; gg <= NumGroups; gg++)
              {
                if (Cows.Age[gg - 1] < weanAge)
                      Cows.Sell(gg, Cows.Number[gg - 1]);
              }


        }


        public void GetPaddockInfo()
        {
            NumPaddocks = 0;
            CurrentLocationNum = 0;

            foreach (Zone paddock in Paddocks)
            {
                NumPaddocks += 1;

                PaddockInfo paddockInfo = new PaddockInfo();

                paddockInfo.paddockName = paddock.Name;
                paddockInfo.paddockNum = NumPaddocks - 1;
                paddockInfo.paddockArea = paddock.Area;

                foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                {
                    paddockInfo.harvestableBiomass += plant.HarvestableWt;
                    paddockInfo.totalBiomass += plant.AboveGroundWt;
                }


                listOfPaddockInfo.Add(paddockInfo);

                if (paddock.Name == CurrentLocationName)
                    CurrentLocationNum = paddockInfo.paddockNum;

                summary.WriteMessage(this, "     Paddock " + NumPaddocks + " is called " + paddock.Name + ", has an area of " + paddock.Area + " ha and an initial harvestable biomass of " + paddockInfo.harvestableBiomass + " kg DM / ha");

            }

        }

        public void UpdatePaddockInfo()
        {
            int ii = -1;

            foreach (Zone paddock in Paddocks)
            {
                ii += 1;
                listOfPaddockInfo[ii].harvestableBiomass = 0.0;
                foreach (PastureSpecies plant in Apsim.Children(paddock, typeof(PastureSpecies)))
                {
                    listOfPaddockInfo[ii].harvestableBiomass += plant.HarvestableWt;
                    listOfPaddockInfo[ii].totalBiomass += plant.AboveGroundWt;
                }

            }

        }


    }
}
]]></Code>
    </Manager>
    <Supplement>
      <Name>Supplement</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <SpoilageTime>0</SpoilageTime>
      <Stores>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>0.85</DMContent>
          <DMD>0</DMD>
          <MEContent>0</MEContent>
          <CPConc>0</CPConc>
          <ProtDg>0</ProtDg>
          <PConc>0</PConc>
          <SConc>0</SConc>
          <EEConc>0</EEConc>
          <ADIP2CP>0</ADIP2CP>
          <AshAlk>0</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>fodder</Name>
          <Stored>0</Stored>
        </StoreType>
        <StoreType>
          <IsRoughage>true</IsRoughage>
          <DMContent>1</DMContent>
          <DMD>0.85</DMD>
          <MEContent>12</MEContent>
          <CPConc>0.16</CPConc>
          <ProtDg>0.70000000000000007</ProtDg>
          <PConc>0.0032</PConc>
          <SConc>0.0024</SConc>
          <EEConc>0.02</EEConc>
          <ADIP2CP>0.06</ADIP2CP>
          <AshAlk>0.6</AshAlk>
          <MaxPassage>0</MaxPassage>
          <Name>silage_highquality</Name>
          <Stored>2000</Stored>
        </StoreType>
      </Stores>
      <PaddockList />
    </Supplement>
    <Report>
      <Name>ReportTop</Name>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <ExperimentFactorNames />
      <ExperimentFactorValues />
      <VariableNames>
        <string>[Clock].Today</string>
        <string>[Ex_TargetRotationLength].Script.listOfPaddockInfo[1].harvestableBiomass as PaddockInfo</string>
        <string>[Ex_TargetRotationLength].Script.CurrentLocation as CurrentLoc</string>
        <string>[Ex_TargetRotationLength].Script.CurrentLocationNum as CurrentLocNum</string>
        <string>[Stock].PastIntakeAll.Weight as IntakePast</string>
        <string>[Stock].SuppIntakeAll.Weight as IntakeSupp</string>
        <string>[Stock].IntakeAll.Weight as IntakePastSupp</string>
        <string>[Stock].Paddock as StockInPaddockName</string>
        <string>[Ex_TargetRotationLength].Script.CurrentLocationNum as StockInPaddockNum</string>
        <string>[Stock].NumberAll</string>
        <string>[Stock].MilkWtAll * 0.1 as MilkSolids</string>
        <string>[Stock].BaseWtAll</string>
        <string>[Stock].CondScoreAll</string>
        <string>[Stock].IntakeAll.Weight * [Stock].NumberAll as TotalIntake</string>
        <string>([Paddock00].Ryegrass.HerbageGrowthWt + [Paddock00].WhiteClover.HerbageGrowthWt) * [Paddock00].Area + ([Paddock01].Ryegrass.HerbageGrowthWt + [Paddock01].WhiteClover.HerbageGrowthWt) * [Paddock01].Area + ([Paddock02].Ryegrass.HerbageGrowthWt + [Paddock02].WhiteClover.HerbageGrowthWt) * [Paddock02].Area as TotalGrowth</string>
        <string>[Supplement].stores[2].Stored</string>
      </VariableNames>
      <EventNames>
        <string>[Clock].EndOfDay</string>
      </EventNames>
    </Report>
    <Folder>
      <Name>Stock Plots</Name>
      <Graph>
        <Name>Live Cows and Location</Name>
        <Series>
          <Name>Live Cows</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <Marker>FilledDiamond</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.NumberAll</YFieldName>
          <ShowInLegend>false</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>Location Number</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Right</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <Marker>FilledDiamond</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>StockInPaddockNum</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Right</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>BodyWt and Milk Production</Name>
        <Series>
          <Name>BodyWeight</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Right</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.BaseWtAll</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>MilkProduction</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16736653</ColourArgb>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>MilkSolids</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Right</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Condition Score</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Stock.CondScoreAll</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>BodyWt and Milk Production1</Name>
        <Series>
          <Name>MilkProduction</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16736653</ColourArgb>
          <Marker>None</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>MilkSolids</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>false</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <ShowPageOfGraphs>true</ShowPageOfGraphs>
    </Folder>
    <Zone>
      <Name>Paddock00</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ResourceName>SurfaceOrganicMatter</ResourceName>
        <InitialResidueName>Sward</InitialResidueName>
        <InitialResidueType>grass</InitialResidueType>
        <InitialResidueMass>1000</InitialResidueMass>
        <InitialStandingFraction>0</InitialStandingFraction>
        <InitialCPR>0</InitialCPR>
        <InitialCNR>15</InitialCNR>
      </SurfaceOrganicMatter>
      <PastureSpecies>
        <Name>Ryegrass</Name>
        <PastureAboveGroundOrgan>
          <Name>Leaves</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stems</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stolons</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Grass</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>2500</InitialShootDM>
        <InitialRootDM>450</InitialRootDM>
        <InitialRootDepth>750</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
        <GrowthTminimum>1</GrowthTminimum>
        <GrowthToptimum>20</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>28</HeatOnsetTemperature>
        <HeatFullTemperature>35</HeatFullTemperature>
        <HeatRecoverySumDD>30</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>1</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>25</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.04</double>
          <double>0.012</double>
          <double>0.05</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.7</FractionLeafMaximum>
        <FractionLeafMinimum>0.7</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0</FractionToStolon>
        <SpecificLeafArea>25</SpecificLeafArea>
        <SpecificRootLength>100</SpecificRootLength>
        <StolonEffectOnLAI>0</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.08</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0</MinimumNFixation>
        <MaximumNFixation>0</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>0.25</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>600</PlantHeightMaximum>
        <PlantHeightMassForMax>10000</PlantHeightMassForMax>
        <PlantHeightExponent>2.8</PlantHeightExponent>
        <RootDepthMinimum>50</RootDepthMinimum>
        <RootDepthMaximum>750</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>90</RootDistributionDepthParam>
        <RootDistributionExponent>3.2</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>100</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <PastureSpecies>
        <Name>WhiteClover</Name>
        <PastureAboveGroundOrgan>
          <Name>Leaves</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stems</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stolons</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Legume</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>500</InitialShootDM>
        <InitialRootDM>150</InitialRootDM>
        <InitialRootDepth>350</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
        <GrowthTminimum>2</GrowthTminimum>
        <GrowthToptimum>22</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>30</HeatOnsetTemperature>
        <HeatFullTemperature>36</HeatFullTemperature>
        <HeatRecoverySumDD>20</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>2</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>30</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.045</double>
          <double>0.02</double>
          <double>0.055</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.56</FractionLeafMaximum>
        <FractionLeafMinimum>0.28</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0.2</FractionToStolon>
        <SpecificLeafArea>30</SpecificLeafArea>
        <SpecificRootLength>45</SpecificRootLength>
        <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.11</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0.2</MinimumNFixation>
        <MaximumNFixation>0.6</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>1</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>350</PlantHeightMaximum>
        <PlantHeightMassForMax>7500</PlantHeightMassForMax>
        <PlantHeightExponent>2.5</PlantHeightExponent>
        <RootDepthMinimum>30</RootDepthMinimum>
        <RootDepthMaximum>350</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>70</RootDistributionDepthParam>
        <RootDistributionExponent>2.5</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>50</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>Ryegrass1Soil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <ResidueInterception>0</ResidueInterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </SoluteManager>
      <Report>
        <Name>Report</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Ryegrass].AboveGroundWt</string>
          <string>[Ryegrass].HarvestableWt</string>
          <string>[WhiteClover].AboveGroundWt</string>
          <string>[WhiteClover].HarvestableWt</string>
          <string>[Ryegrass].AboveGroundWt + [WhiteClover].AboveGroundWt as PaddockBiomass</string>
          <string>[Ryegrass].HerbageGrowthWt + [WhiteClover].HerbageGrowthWt as PGR</string>
          <string>([Ryegrass].HerbageGrowthWt + [WhiteClover].HerbageGrowthWt) * [Zone].Area as PaddockFeedAccum</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Zone>
      <Name>Paddock01</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ResourceName>SurfaceOrganicMatter</ResourceName>
        <InitialResidueName>Sward</InitialResidueName>
        <InitialResidueType>grass</InitialResidueType>
        <InitialResidueMass>1000</InitialResidueMass>
        <InitialStandingFraction>0</InitialStandingFraction>
        <InitialCPR>0</InitialCPR>
        <InitialCNR>15</InitialCNR>
      </SurfaceOrganicMatter>
      <PastureSpecies>
        <Name>Ryegrass</Name>
        <PastureAboveGroundOrgan>
          <Name>Leaves</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stems</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stolons</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Grass</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>2500</InitialShootDM>
        <InitialRootDM>450</InitialRootDM>
        <InitialRootDepth>750</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
        <GrowthTminimum>1</GrowthTminimum>
        <GrowthToptimum>20</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>28</HeatOnsetTemperature>
        <HeatFullTemperature>35</HeatFullTemperature>
        <HeatRecoverySumDD>30</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>1</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>25</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.04</double>
          <double>0.012</double>
          <double>0.05</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.7</FractionLeafMaximum>
        <FractionLeafMinimum>0.7</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0</FractionToStolon>
        <SpecificLeafArea>25</SpecificLeafArea>
        <SpecificRootLength>100</SpecificRootLength>
        <StolonEffectOnLAI>0</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.08</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0</MinimumNFixation>
        <MaximumNFixation>0</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>0.25</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>600</PlantHeightMaximum>
        <PlantHeightMassForMax>10000</PlantHeightMassForMax>
        <PlantHeightExponent>2.8</PlantHeightExponent>
        <RootDepthMinimum>50</RootDepthMinimum>
        <RootDepthMaximum>750</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>90</RootDistributionDepthParam>
        <RootDistributionExponent>3.2</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>100</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <PastureSpecies>
        <Name>WhiteClover</Name>
        <PastureAboveGroundOrgan>
          <Name>Leaves</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stems</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stolons</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Legume</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>500</InitialShootDM>
        <InitialRootDM>150</InitialRootDM>
        <InitialRootDepth>350</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
        <GrowthTminimum>2</GrowthTminimum>
        <GrowthToptimum>22</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>30</HeatOnsetTemperature>
        <HeatFullTemperature>36</HeatFullTemperature>
        <HeatRecoverySumDD>20</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>2</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>30</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.045</double>
          <double>0.02</double>
          <double>0.055</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.56</FractionLeafMaximum>
        <FractionLeafMinimum>0.28</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0.2</FractionToStolon>
        <SpecificLeafArea>30</SpecificLeafArea>
        <SpecificRootLength>45</SpecificRootLength>
        <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.11</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0.2</MinimumNFixation>
        <MaximumNFixation>0.6</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>1</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>350</PlantHeightMaximum>
        <PlantHeightMassForMax>7500</PlantHeightMassForMax>
        <PlantHeightExponent>2.5</PlantHeightExponent>
        <RootDepthMinimum>30</RootDepthMinimum>
        <RootDepthMaximum>350</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>70</RootDistributionDepthParam>
        <RootDistributionExponent>2.5</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>50</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>Ryegrass1Soil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <ResidueInterception>0</ResidueInterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </SoluteManager>
      <Report>
        <Name>Report</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Ryegrass].AboveGroundWt</string>
          <string>[Ryegrass].HarvestableWt</string>
          <string>[WhiteClover].AboveGroundWt</string>
          <string>[WhiteClover].HarvestableWt</string>
          <string>[Ryegrass].AboveGroundWt + [WhiteClover].AboveGroundWt as PaddockBiomass</string>
          <string>[Ryegrass].HerbageGrowthWt + [WhiteClover].HerbageGrowthWt as PGR</string>
          <string>([Ryegrass].HerbageGrowthWt + [WhiteClover].HerbageGrowthWt) * [Zone].Area as PaddockFeedAccum</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Zone>
      <Name>Paddock02</Name>
      <Folder>
        <Name>Managers</Name>
        <Manager>
          <Name>AutomaticFertiliser</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Script>
            <AllowFertiliser>yes</AllowFertiliser>
            <Depth2SoilN>500</Depth2SoilN>
            <CriticalSoilN>5</CriticalSoilN>
            <FertNAmount>25</FertNAmount>
            <FertType>UreaN</FertType>
            <FertApplicationDepth>1</FertApplicationDepth>
            <FertMinimumDays>15</FertMinimumDays>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using APSIM.Shared.Utilities;
using System.Xml.Serialization;

namespace Models
{
    [Serializable]
    public class Script : Model
    {
        [Link] Clock Clock;
        [Link] Fertiliser fertiliser;
        [Link] ISummary summary = null;
        [Link] Soil Soil;

        //User inputs from properties tab
        [Description("Turn ferliser applications on? ")]
        public yesnoType AllowFertiliser { get; set; }
        
        [Description("Depth to calculate available soil N (mm): ")]
        public double Depth2SoilN { get; set; }

        [Description("Minimum available N, triggers an application (kgN/ha): ")]
        public double CriticalSoilN { get; set; }

        [Description("Amount of N fertiliser for each application (kgN/ha): ")]
        public double FertNAmount { get; set; }

        [Description("Type of N fertiliser to apply: ")]
        public Fertiliser.Types FertType { get; set; }

        [Description("Depth at which to apply the fertiliser (mm): ")]
        public double FertApplicationDepth { get; set; }
       
        [Description("Minimum period between applications (days): ")]
        public double FertMinimumDays { get; set; }
       
        public enum yesnoType
        {
            /// <summary>a positive answer</summary>
            yes,
            /// <summary>a negative answer</summary>
            no
        }

        [XmlIgnore] public double TopMineralN { get; set; }
        
        private DateTime lastApplicationDate;
        private bool fertiliserIsAllowed;
        private int nLayers;

        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {
            fertiliserIsAllowed = (AllowFertiliser == yesnoType.yes);
            nLayers = Soil.Thickness.Length;
        }

        [EventSubscribe("DoManagement")]
        private void OnDoManagement(object sender, EventArgs e)
        {
            double daysSinceLastApplication = (Clock.Today - lastApplicationDate).TotalDays;
            
            // get the N stored in the soil
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopMineralN = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (Depth2SoilN - depthFromSurface) / Soil.Thickness[layer]);
                TopMineralN += (Soil.SoilNitrogen.NO3[layer]
                + Soil.SoilNitrogen.NH4[layer]
                + Soil.SoilNitrogen.urea[layer])
                * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= Depth2SoilN)
                    layer = nLayers;
            }

            if (fertiliserIsAllowed && (daysSinceLastApplication >= FertMinimumDays) && (TopMineralN <= CriticalSoilN))
            {
                fertiliser.Apply(FertNAmount, FertType, FertApplicationDepth);
                lastApplicationDate = Clock.Today;
            }
        }
    }
}
]]></Code>
        </Manager>
        <Manager>
          <Name>AutomaticIrrigation</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Script>
            <allowIrrigation>True</allowIrrigation>
            <seasonStart>15-Aug</seasonStart>
            <seasonEnd>30-May</seasonEnd>
            <seasonsAllocation>10000</seasonsAllocation>
            <triggerDeficit>75</triggerDeficit>
            <targetDeficit>99</targetDeficit>
            <returndays>1</returndays>
            <maximumAmount>30</maximumAmount>
            <depthPAWC>300</depthPAWC>
          </Script>
          <Code><![CDATA[using System;
using Models.Core;
using Models.PMF;
using Models.Soils;
using System.Xml.Serialization;
using Models.PMF;
using APSIM.Shared.Utilities;

        
namespace Models
{
    [Serializable] 
    [System.Xml.Serialization.XmlInclude(typeof(Model))]
    public class Script : Model
    {
        //Communication to other modules
        [Link] ISummary summary = null;
        [Link] Irrigation Irrigation;
        [Link] Clock Clock;
        [Link] Soil Soil;
        [Link(IsOptional = true)] IPlant existingCrop;
       
        //User inputs from properties tab
        [Description("Turn irrigation on?")]
        public bool allowIrrigation { get; set; }
        [Description("Start of irrigation season (dd-MMM)")]
        public string seasonStart { get; set; }
        [Description("End of irrigation season (dd-MMM)")]
        public string seasonEnd { get; set; }
        [Description("Season allocation (mm)")]
        public double seasonsAllocation { get; set; }
        [Description("Deficit to trigger irrigation (% PAWC)")]
        public double triggerDeficit { get; set; }
        [Description("Deficit to stop irrigaton (% PAWC)")]
        public double targetDeficit { get; set; }
        [Description("Minimum days for irrigation to return")]
        public double returndays { get; set; }
        [Description("Maximum irrigation application (mm/day)")]
        public double maximumAmount { get; set; }
        [Description("Depth to calculate PAWC (mm)")]
        public double depthPAWC { get; set; }

        //Class members
        [XmlIgnore] public double TopSWdeficit { get; set; }
        [XmlIgnore] public double TopSWC { get; set; }
        [XmlIgnore] public double DaysSinceIrrigation { get; set; }
        [XmlIgnore] public double AmountToApply { get; set; }
        [XmlIgnore] public double SeasonAppliedAmount { get; set; }
        
        private bool IrrigationIsAllowed { get; set; }
        private bool SeasonIsOpen { get; set; }
        private bool CropIsActive { get; set; }
        private bool IrrigatorIsAvailable { get; set; }
        private bool SoilIsDry { get; set; }

        private DateTime StartDate;
        private DateTime EndDate;
        private double TopDUL;
        private double TopLL;
        private int nLayers;
    
        //Calculate static soil variables
        [EventSubscribe("StartOfSimulation")]
        private void OnStartOfSimulation(object sender, EventArgs e)
        {   
            //Set the season dates
            StartDate = DateTime.Parse(seasonStart + "-" + Clock.Today.Year.ToString());
            EndDate = DateTime.Parse(seasonEnd + "-" + Clock.Today.Year.ToString());
            
            //Can we irrigate at all?
            IrrigationIsAllowed = false; 
            if (allowIrrigation)
                IrrigationIsAllowed = true; 

            //Calculate soil water variables
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            nLayers = Soil.Thickness.Length;
            for (int layer = 0; layer < nLayers; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopLL += Soil.LL15mm[layer] * fracLayer;
                TopDUL += Soil.DULmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
        }
             
        //Determine daily requirement for irrigation
        [EventSubscribe("StartOfDay")]
        private void OnStartOfDay(object sender, EventArgs e)
        {
            //Can we irrigate today?          
            SeasonIsOpen = isBetween(Clock.Today, StartDate, EndDate);

            //Is there a crop in the ground that needs irrigation?
            CropIsActive = false;
            if ((existingCrop != null) && (existingCrop.IsAlive))
                CropIsActive = true;
            //if ((existingCrop.Phenology.Stage >= 3.0) && (existingCrop.Phenology.Stage < 6.0))
          
            //Is the irrigator available?
            IrrigatorIsAvailable = false;
            DaysSinceIrrigation += 1;
            if (DaysSinceIrrigation >= returndays)
                IrrigatorIsAvailable = true;
          
            //Is the soil dry enough to require irrigation?
            SoilIsDry = false;
            double depthFromSurface = 0.0;
            double fracLayer = 0.0;
            TopSWC = 0.0;
            for (int layer = 0; layer < nLayers; layer++)
            //for (int layer = 0; depthFromSurface < depthPAWC + Soil.Thickness[layer]; layer++)
            {
                fracLayer = Math.Min(1.0, (depthPAWC - depthFromSurface) / Soil.Thickness[layer]);
                TopSWC += Soil.SoilWater.SWmm[layer] * fracLayer;
                depthFromSurface += Soil.Thickness[layer];
                if (depthFromSurface >= depthPAWC)
                    layer = nLayers;
            }
            
            TopSWdeficit = TopSWC - TopDUL;
            if (Math.Max(0.0, -TopSWdeficit) >= (TopDUL - TopLL) * (100 - triggerDeficit) / 100)
                SoilIsDry = true;
                
            //Are all the conditions ratifying irrigation
            if (IrrigationIsAllowed && SeasonIsOpen && CropIsActive && IrrigatorIsAvailable && SoilIsDry)
            {
                //Lets bloody well irrigate then!!!!
                AmountToApply = TopDUL * targetDeficit / 100 - TopSWC;
                AmountToApply = Math.Max(0.0, Math.Min(AmountToApply, seasonsAllocation - SeasonAppliedAmount));
                Irrigation.Apply(AmountToApply);
                DaysSinceIrrigation = 0;
                SeasonAppliedAmount += AmountToApply;
            }
        }
        
        ///Checks whether theDate is between iniDate and endDate (non-year specific)
        private bool isBetween(DateTime theDay, DateTime iniDate, DateTime endDate)
        {
            bool result = false;
            if (iniDate.DayOfYear < endDate.DayOfYear)
            {
                // period is within one year, ex: summer in the northern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) && (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            else
            {
                // period goes over the end of the year, ex: summer in the southern hemisphere
                if ((theDay.DayOfYear >= iniDate.DayOfYear) || (theDay.DayOfYear <= endDate.DayOfYear))
                    result = true;
            }
            
            return result;
        }
    }
}
]]></Code>
        </Manager>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ShowPageOfGraphs>true</ShowPageOfGraphs>
      </Folder>
      <MicroClimate>
        <Name>MicroClimate</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <a_interception>0</a_interception>
        <b_interception>0</b_interception>
        <c_interception>0</c_interception>
        <d_interception>0</d_interception>
        <soil_albedo>0.23</soil_albedo>
        <sun_angle>15</sun_angle>
        <soil_heat_flux_fraction>0.4</soil_heat_flux_fraction>
        <night_interception_fraction>0.5</night_interception_fraction>
        <refheight>2</refheight>
        <albedo>0.29366217672824863</albedo>
        <emissivity>0.96</emissivity>
        <RadIntTotal>0</RadIntTotal>
      </MicroClimate>
      <Irrigation>
        <Name>Irrigation</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </Irrigation>
      <Fertiliser>
        <Name>Fertiliser</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </Fertiliser>
      <SurfaceOrganicMatter>
        <Name>SurfaceOrganicMatter</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ResourceName>SurfaceOrganicMatter</ResourceName>
        <InitialResidueName>Sward</InitialResidueName>
        <InitialResidueType>grass</InitialResidueType>
        <InitialResidueMass>1000</InitialResidueMass>
        <InitialStandingFraction>0</InitialStandingFraction>
        <InitialCPR>0</InitialCPR>
        <InitialCNR>15</InitialCNR>
      </SurfaceOrganicMatter>
      <PastureSpecies>
        <Name>Ryegrass</Name>
        <PastureAboveGroundOrgan>
          <Name>Leaves</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stems</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stolons</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Grass</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>2500</InitialShootDM>
        <InitialRootDM>450</InitialRootDM>
        <InitialRootDepth>750</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.5</LightExtinctionCoefficient>
        <GrowthTminimum>1</GrowthTminimum>
        <GrowthToptimum>20</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>28</HeatOnsetTemperature>
        <HeatFullTemperature>35</HeatFullTemperature>
        <HeatRecoverySumDD>30</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>1</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>25</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.03</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.04</double>
          <double>0.012</double>
          <double>0.05</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.02</double>
          <double>0.006</double>
          <double>0.025</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.7</FractionLeafMaximum>
        <FractionLeafMinimum>0.7</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0</FractionToStolon>
        <SpecificLeafArea>25</SpecificLeafArea>
        <SpecificRootLength>100</SpecificRootLength>
        <StolonEffectOnLAI>0</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>1000</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>1</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.08</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0</MinimumNFixation>
        <MaximumNFixation>0</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>0.25</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>600</PlantHeightMaximum>
        <PlantHeightMassForMax>10000</PlantHeightMassForMax>
        <PlantHeightExponent>2.8</PlantHeightExponent>
        <RootDepthMinimum>50</RootDepthMinimum>
        <RootDepthMaximum>750</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>90</RootDistributionDepthParam>
        <RootDistributionExponent>3.2</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>100</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <PastureSpecies>
        <Name>WhiteClover</Name>
        <PastureAboveGroundOrgan>
          <Name>Leaves</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stems</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <PastureAboveGroundOrgan>
          <Name>Stolons</Name>
          <GenericTissue>
            <Name>LeafCohort1</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort2</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>LeafCohort3</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <GenericTissue>
            <Name>Dead</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
          </GenericTissue>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </PastureAboveGroundOrgan>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <MaximumNUptake>10</MaximumNUptake>
        <Albedo>0.26</Albedo>
        <Gsmax>0.011</Gsmax>
        <R50>200</R50>
        <SpeciesFamily>Legume</SpeciesFamily>
        <PhotosyntheticPathway>C3</PhotosyntheticPathway>
        <InitialShootDM>500</InitialShootDM>
        <InitialRootDM>150</InitialRootDM>
        <InitialRootDepth>350</InitialRootDepth>
        <ReferencePhotosyntheticRate>1</ReferencePhotosyntheticRate>
        <LightExtinctionCoefficient>0.8</LightExtinctionCoefficient>
        <GrowthTminimum>2</GrowthTminimum>
        <GrowthToptimum>22</GrowthToptimum>
        <GrowthTEffectExponent>1.7</GrowthTEffectExponent>
        <UseHeatStressFactor>yes</UseHeatStressFactor>
        <HeatOnsetTemperature>30</HeatOnsetTemperature>
        <HeatFullTemperature>36</HeatFullTemperature>
        <HeatRecoverySumDD>20</HeatRecoverySumDD>
        <HeatRecoveryTReference>25</HeatRecoveryTReference>
        <UseColdStressFactor>yes</UseColdStressFactor>
        <ColdOnsetTemperature>2</ColdOnsetTemperature>
        <ColdFullTemperature>-5</ColdFullTemperature>
        <ColdRecoverySumDD>30</ColdRecoverySumDD>
        <ColdRecoveryTReference>0</ColdRecoveryTReference>
        <MaintenanceRespirationCoefficient>0.04</MaintenanceRespirationCoefficient>
        <GrowthRespirationCoefficient>0.25</GrowthRespirationCoefficient>
        <RespirationTReference>20</RespirationTReference>
        <RespirationExponent>1.5</RespirationExponent>
        <NThresholdsForLeaves>
          <double>0.045</double>
          <double>0.02</double>
          <double>0.055</double>
        </NThresholdsForLeaves>
        <NThresholdsForStems>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStems>
        <NThresholdsForStolons>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForStolons>
        <NThresholdsForRoots>
          <double>0.0225</double>
          <double>0.01</double>
          <double>0.0275</double>
        </NThresholdsForRoots>
        <DegreesDayForGermination>125</DegreesDayForGermination>
        <TargetShootRootRatio>4</TargetShootRootRatio>
        <MaxRootAllocation>0.25</MaxRootAllocation>
        <ShootRootGlfFactor>0.5</ShootRootGlfFactor>
        <UseReproSeasonFactor>yes</UseReproSeasonFactor>
        <ReproSeasonReferenceLatitude>41</ReproSeasonReferenceLatitude>
        <ReproSeasonTimingCoeff>0.14</ReproSeasonTimingCoeff>
        <ReproSeasonMaxAllocationIncrease>0.5</ReproSeasonMaxAllocationIncrease>
        <ReproSeasonAllocationCoeff>0.1</ReproSeasonAllocationCoeff>
        <FractionLeafMaximum>0.56</FractionLeafMaximum>
        <FractionLeafMinimum>0.28</FractionLeafMinimum>
        <FractionLeafDMThreshold>500</FractionLeafDMThreshold>
        <FractionLeafDMFactor>2000</FractionLeafDMFactor>
        <FractionLeafExponent>3</FractionLeafExponent>
        <FractionToStolon>0.2</FractionToStolon>
        <SpecificLeafArea>30</SpecificLeafArea>
        <SpecificRootLength>45</SpecificRootLength>
        <StolonEffectOnLAI>0.3</StolonEffectOnLAI>
        <ShootMaxEffectOnLAI>500</ShootMaxEffectOnLAI>
        <MaxStemEffectOnLAI>0.5</MaxStemEffectOnLAI>
        <LiveLeavesPerTiller>3</LiveLeavesPerTiller>
        <TissueTurnoverRateShoot>0.05</TissueTurnoverRateShoot>
        <TissueTurnoverRateRoot>0.02</TissueTurnoverRateRoot>
        <DetachmentRateShoot>0.11</DetachmentRateShoot>
        <TurnoverTemperatureMin>2</TurnoverTemperatureMin>
        <TurnoverTemperatureRef>20</TurnoverTemperatureRef>
        <TurnoverTemperatureExponent>1</TurnoverTemperatureExponent>
        <TurnoverDroughtEffectMax>1</TurnoverDroughtEffectMax>
        <TurnoverDroughtThreshold>0.5</TurnoverDroughtThreshold>
        <TurnoverDefoliationCoefficient>0.5</TurnoverDefoliationCoefficient>
        <TurnoverDefoliationRootEffect>0.1</TurnoverDefoliationRootEffect>
        <FractionNLuxuryRemobilisable>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </FractionNLuxuryRemobilisable>
        <MinimumNFixation>0.2</MinimumNFixation>
        <MaximumNFixation>0.6</MaximumNFixation>
        <SoilSaturationEffectMax>0.1</SoilSaturationEffectMax>
        <MinimumWaterFreePorosity>-1</MinimumWaterFreePorosity>
        <SoilSaturationRecoveryFactor>0.25</SoilSaturationRecoveryFactor>
        <NDillutionCoefficient>1</NDillutionCoefficient>
        <GlfGeneric>1</GlfGeneric>
        <GlfSoilFertility>1</GlfSoilFertility>
        <PlantHeightMinimum>25</PlantHeightMinimum>
        <PlantHeightMaximum>350</PlantHeightMaximum>
        <PlantHeightMassForMax>7500</PlantHeightMassForMax>
        <PlantHeightExponent>2.5</PlantHeightExponent>
        <RootDepthMinimum>30</RootDepthMinimum>
        <RootDepthMaximum>350</RootDepthMaximum>
        <RootElongationRate>25</RootElongationRate>
        <RootDistributionDepthParam>70</RootDistributionDepthParam>
        <RootDistributionExponent>2.5</RootDistributionExponent>
        <DigestibilitiesCellWall>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.6</double>
          <double>0.2</double>
        </DigestibilitiesCellWall>
        <MinimumGreenWt>50</MinimumGreenWt>
        <FractionStolonStanding>0</FractionStolonStanding>
        <PreferenceForGreenOverDead>1</PreferenceForGreenOverDead>
        <PreferenceForLeafOverStems>1</PreferenceForLeafOverStems>
        <WaterAvailableMethod>DefaultAPSIM</WaterAvailableMethod>
        <NitrogenAvailableMethod>BasicAgPasture</NitrogenAvailableMethod>
      </PastureSpecies>
      <Soil>
        <Name>LismoreSoil</Name>
        <Analysis>
          <Name>Analysis</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>10</double>
            <double>40</double>
            <double>60</double>
            <double>70</double>
            <double>70</double>
          </Rocks>
          <Texture />
          <MunsellColour />
          <PH>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
            <double>6</double>
          </PH>
          <CEC>
            <double>12.5</double>
            <double>10</double>
            <double>9</double>
            <double>5</double>
            <double>4</double>
            <double>4</double>
            <double>4</double>
          </CEC>
          <ParticleSizeSand>
            <double>15</double>
            <double>20</double>
            <double>25</double>
            <double>35</double>
            <double>40</double>
            <double>40</double>
            <double>40</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>65</double>
            <double>65</double>
            <double>63</double>
            <double>57</double>
            <double>54</double>
            <double>55</double>
            <double>55</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>20</double>
            <double>15</double>
            <double>12</double>
            <double>8</double>
            <double>6</double>
            <double>5</double>
            <double>5</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Water>
          <Name>Water</Name>
          <SoilCrop>
            <Name>SwardSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>RyegrassSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>WhiteCloverSoil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop>
            <Name>Ryegrass1Soil</Name>
            <IncludeInDocumentation>true</IncludeInDocumentation>
            <Enabled>true</Enabled>
            <LL>
              <double>0.15</double>
              <double>0.14</double>
              <double>0.06</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.08</double>
              <double>0.04</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.3</double>
            <double>1.35</double>
            <double>1</double>
            <double>0.53</double>
            <double>0.31</double>
            <double>0.3</double>
            <double>0.3</double>
          </BD>
          <AirDry>
            <double>0.05</double>
            <double>0.12</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </AirDry>
          <LL15>
            <double>0.15</double>
            <double>0.14</double>
            <double>0.055</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </LL15>
          <DUL>
            <double>0.36</double>
            <double>0.34</double>
            <double>0.19</double>
            <double>0.065</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.03</double>
          </DUL>
          <SAT>
            <double>0.45</double>
            <double>0.43</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.11</double>
          </SAT>
          <KS>
            <double>5000</double>
            <double>2500</double>
            <double>3000</double>
            <double>10000</double>
            <double>17500</double>
            <double>20000</double>
            <double>20000</double>
          </KS>
        </Water>
        <SoilWater>
          <Name>SoilWater</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <SummerDate>1-Nov</SummerDate>
          <SummerU>6</SummerU>
          <SummerCona>3.5</SummerCona>
          <WinterDate>1-apr</WinterDate>
          <WinterU>2</WinterU>
          <WinterCona>2</WinterCona>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <slope>0</slope>
          <discharge_width>0</discharge_width>
          <catchment_area>0</catchment_area>
          <max_pond>0</max_pond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.5</double>
            <double>0.52</double>
            <double>0.55</double>
            <double>0.6</double>
            <double>0.65</double>
            <double>0.65</double>
            <double>0.65</double>
          </SWCON>
          <KLAT>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </KLAT>
          <ResidueInterception>0</ResidueInterception>
        </SoilWater>
        <SoilNitrogen>
          <Name>SoilNitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <fom_type>
            <string>default</string>
            <string>manure</string>
            <string>mucuna</string>
            <string>lablab</string>
            <string>shemp</string>
            <string>stable</string>
          </fom_type>
          <fract_carb>
            <double>0.2</double>
            <double>0.3</double>
            <double>0.54</double>
            <double>0.57</double>
            <double>0.45</double>
            <double>0</double>
          </fract_carb>
          <fract_cell>
            <double>0.7</double>
            <double>0.3</double>
            <double>0.37</double>
            <double>0.37</double>
            <double>0.47</double>
            <double>0.1</double>
          </fract_cell>
          <fract_lign>
            <double>0.1</double>
            <double>0.4</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.08</double>
            <double>0.9</double>
          </fract_lign>
        </SoilNitrogen>
        <SoilOrganicMatter>
          <Name>SoilOrganicMatter</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Depth>
            <string>0-15</string>
            <string>15-30</string>
            <string>30-50</string>
            <string>50-65</string>
            <string>65-90</string>
            <string>90-120</string>
            <string>120-150</string>
          </Depth>
          <OC>
            <double>3</double>
            <double>1</double>
            <double>0.6</double>
            <double>0.4</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0</double>
            <double>0</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.7</double>
            <double>0.83</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <InitialWater>
          <Name>Initial water</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <FractionFull>0.95</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
        </InitialWater>
        <Sample>
          <Name>Initial nitrogen</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>200</double>
            <double>150</double>
            <double>250</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2.5</double>
            <double>1</double>
            <double>0.75</double>
            <double>0.5</double>
            <double>0.5</double>
            <double>0.5</double>
          </NO3>
          <NH4>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <CERESSoilTemperature>
          <Name>CERESSoilTemperature</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
        </CERESSoilTemperature>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <RecordNumber>0</RecordNumber>
        <SoilType>NZ_Sedimentary</SoilType>
        <LocalName>Lismore</LocalName>
        <Site>Winchmore</Site>
        <NearestTown>Ashburton</NearestTown>
        <Region>Canterbury</Region>
        <Country>New Zealand</Country>
        <NaturalVegetation />
        <Latitude>-48.48</Latitude>
        <Longitude>0</Longitude>
      </Soil>
      <SoluteManager>
        <Name>SoluteManager</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
      </SoluteManager>
      <Report>
        <Name>Report</Name>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <ExperimentFactorNames />
        <ExperimentFactorValues />
        <VariableNames>
          <string>[Clock].Today</string>
          <string>[Ryegrass].AboveGroundWt</string>
          <string>[Ryegrass].HarvestableWt</string>
          <string>[WhiteClover].AboveGroundWt</string>
          <string>[WhiteClover].HarvestableWt</string>
          <string>[Ryegrass].AboveGroundWt + [WhiteClover].AboveGroundWt as PaddockBiomass</string>
          <string>[Ryegrass].HerbageGrowthWt + [WhiteClover].HerbageGrowthWt as PGR</string>
          <string>([Ryegrass].HerbageGrowthWt + [WhiteClover].HerbageGrowthWt) * [Zone].Area as PaddockFeedAccum</string>
        </VariableNames>
        <EventNames>
          <string>[Clock].EndOfDay</string>
        </EventNames>
      </Report>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <Area>1</Area>
      <Slope>0</Slope>
    </Zone>
    <Folder>
      <Name>Biomass and Intake</Name>
      <Graph>
        <Name>Biomass</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorToVaryColours>Zone</FactorToVaryColours>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>PaddockBiomass</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Intake</Name>
        <Series>
          <Name>Pasture</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>IntakePast</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>PastureAndSilage</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>IntakePastSupp</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>Silage</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Right</YAxis>
          <ColourArgb>-11094807</ColourArgb>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>IntakeSupp</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Right</Type>
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>Total Intake and Growth</Name>
        <Series>
          <Name>TotIntake</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>TotalIntake</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <Series>
          <Name>TotGrowth</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-1663232</ColourArgb>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>TotalGrowth</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>true</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>PGR</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-16777216</ColourArgb>
          <FactorToVaryColours>Zone</FactorToVaryColours>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>Report</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>PGR</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <Graph>
        <Name>SupplementStore</Name>
        <Series>
          <Name>Series1</Name>
          <IncludeInDocumentation>true</IncludeInDocumentation>
          <Enabled>true</Enabled>
          <Type>Scatter</Type>
          <XAxis>Bottom</XAxis>
          <YAxis>Left</YAxis>
          <ColourArgb>-11094807</ColourArgb>
          <Marker>FilledCircle</Marker>
          <MarkerSize>Normal</MarkerSize>
          <Line>Solid</Line>
          <LineThickness>Normal</LineThickness>
          <Checkpoint>Current</Checkpoint>
          <TableName>ReportTop</TableName>
          <XFieldName>Clock.Today</XFieldName>
          <YFieldName>Supplement.stores2.Stored</YFieldName>
          <ShowInLegend>true</ShowInLegend>
          <IncludeSeriesNameInLegend>false</IncludeSeriesNameInLegend>
          <Cumulative>false</Cumulative>
          <CumulativeX>false</CumulativeX>
        </Series>
        <IncludeInDocumentation>true</IncludeInDocumentation>
        <Enabled>true</Enabled>
        <Axis>
          <Type>Bottom</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <Axis>
          <Type>Left</Type>
          <Title />
          <Inverted>false</Inverted>
          <Minimum>NaN</Minimum>
          <Maximum>NaN</Maximum>
          <Interval>NaN</Interval>
        </Axis>
        <LegendPosition>TopLeft</LegendPosition>
        <DisabledSeries />
      </Graph>
      <IncludeInDocumentation>true</IncludeInDocumentation>
      <Enabled>true</Enabled>
      <ShowPageOfGraphs>true</ShowPageOfGraphs>
    </Folder>
    <IncludeInDocumentation>true</IncludeInDocumentation>
    <Enabled>true</Enabled>
  </Simulation>
  <DataStore>
    <Name>DataStore</Name>
    <IncludeInDocumentation>true</IncludeInDocumentation>
    <Enabled>true</Enabled>
  </DataStore>
  <IncludeInDocumentation>true</IncludeInDocumentation>
  <Enabled>true</Enabled>
  <ExplorerWidth>300</ExplorerWidth>
</Simulations>